<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Baccarat Commission Structure Calculator - Wizard of Odds</title>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/recharts@2.5.0/dist/Recharts.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        body { margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;
        const { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } = Recharts;

        const Calculator = () => (<svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="4" y="2" width="16" height="20" rx="2"></rect><line x1="8" y1="6" x2="16" y2="6"></line></svg>);
        const DollarSign = () => (<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="1" x2="12" y2="23"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg>);
        const TrendingDown = () => (<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="23 18 13.5 8.5 8.5 13.5 1 6"></polyline></svg>);
        const Clock = () => (<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>);
        const AlertCircle = () => (<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line></svg>);

        function CommissionCalculator() {
            const [baseBet, setBaseBet] = useState(100);
            const [handsPerHour, setHandsPerHour] = useState(60);
            const [hoursPlayed, setHoursPlayed] = useState(2);
            const [selectedVariant, setSelectedVariant] = useState('traditional');
            const [betType, setBetType] = useState('banker');

            // House edges from WizardofOdds.com combinatorial analysis
            const gameVariants = {
                traditional: {
                    name: "Traditional 5% Commission",
                    description: "Standard baccarat with 5% commission on Banker wins",
                    bankerHouseEdge: 1.0579,
                    playerHouseEdge: 1.2351,
                    notes: "Classic format. Banker wins pay 0.95:1 after 5% commission. Source: WizardofOdds.com/games/baccarat/basics/"
                },
                noCommission: {
                    name: "No Commission (Banker 6 pays 1:2)",
                    description: "No commission, but Banker wins with 6 pay only 1:2",
                    bankerHouseEdge: 1.4613,
                    playerHouseEdge: 1.2351,
                    notes: "Popular in Asia. Higher house edge than traditional despite 'no commission' label. Source: WizardofOdds.com/games/baccarat/appendix/6/"
                },
                super6: {
                    name: "Super 6 (Banker 6 pushes)",
                    description: "No commission, Banker wins with 6 push (no win/loss)",
                    bankerHouseEdge: 1.5398,
                    playerHouseEdge: 1.2351,
                    notes: "Less common variant. Highest house edge of common formats. Banker 6 occurs ~5.3% of hands."
                },
                commission4: {
                    name: "4% Commission",
                    description: "Reduced commission to 4% on Banker wins",
                    bankerHouseEdge: 0.6003,
                    playerHouseEdge: 1.2351,
                    notes: "Rare but most favorable for Banker bettors. Approximately half the house edge of traditional format."
                }
            };

            const calculateExpectedResults = (variant, betType = 'banker') => {
                const totalHands = handsPerHour * hoursPlayed;
                const totalWagered = baseBet * totalHands;
                const houseEdge = betType === 'banker' ? variant.bankerHouseEdge : variant.playerHouseEdge;
                const expectedLoss = (totalWagered * houseEdge) / 100;
                const expectedCostPerHour = expectedLoss / hoursPlayed;
                
                // Variance from probability theory: Var(X) for baccarat bets
                const variance = betType === 'banker' ? 0.9295 : 0.9482;
                const standardDeviation = Math.sqrt(totalHands * variance) * baseBet;
                
                // Bankroll requirements using normal approximation
                const required95Bankroll = expectedLoss + (1.96 * standardDeviation);
                const required99Bankroll = expectedLoss + (2.576 * standardDeviation);

                return { totalHands, totalWagered, expectedLoss, expectedCostPerHour, houseEdge, standardDeviation, required95Bankroll, required99Bankroll };
            };

            const formatCurrency = (value) => new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 2 }).format(value);
            const currentVariant = gameVariants[selectedVariant];
            const currentResults = calculateExpectedResults(currentVariant, betType);

            const edgeComparisonData = Object.entries(gameVariants).map(([key, variant]) => ({
                name: variant.name.split(' (')[0],
                'Banker Edge': variant.bankerHouseEdge,
                'Player Edge': variant.playerHouseEdge
            }));

            const costComparisonData = Object.entries(gameVariants).map(([key, variant]) => {
                const bankerResults = calculateExpectedResults(variant, 'banker');
                const playerResults = calculateExpectedResults(variant, 'player');
                return {
                    name: variant.name.split(' (')[0],
                    'Banker Bet': bankerResults.expectedLoss,
                    'Player Bet': playerResults.expectedLoss
                };
            });

            return (
                <div className="min-h-screen bg-gradient-to-br from-green-900 via-black to-red-900 p-4 md:p-8">
                    <div className="max-w-7xl mx-auto">
                        <div className="mb-4">
                            <a href="index.html" className="text-blue-400 hover:text-blue-300 underline">← Back to Index</a>
                        </div>

                        <div className="bg-black/60 backdrop-blur-sm rounded-lg p-6 mb-6 border border-green-800/50">
                            <h1 className="text-3xl md:text-4xl font-bold text-white mb-2 flex items-center gap-3">
                                <Calculator />
                                Baccarat Commission Structure Calculator
                            </h1>
                            <p className="text-gray-300 text-lg">
                                Compare house edges and expected costs across baccarat variants using published mathematical analysis
                            </p>
                            <p className="text-gray-400 text-sm mt-2">
                                By Joey Shackelford | All values verified against WizardofOdds.com combinatorial analysis
                            </p>
                        </div>

                        <div className="bg-black/60 backdrop-blur-sm rounded-lg p-6 mb-6 border border-blue-800/50">
                            <h2 className="text-2xl font-bold text-white mb-4">Session Parameters</h2>
                            <div className="grid md:grid-cols-3 gap-6">
                                <div>
                                    <label className="block text-white font-semibold mb-2">Bet Size per Hand ($)</label>
                                    <input type="number" value={baseBet} onChange={(e) => setBaseBet(Math.max(1, parseInt(e.target.value) || 100))} className="w-full bg-gray-800 text-white border border-gray-600 rounded px-4 py-2" />
                                </div>
                                <div>
                                    <label className="block text-white font-semibold mb-2">Hands Per Hour</label>
                                    <input type="number" value={handsPerHour} onChange={(e) => setHandsPerHour(Math.max(1, parseInt(e.target.value) || 60))} className="w-full bg-gray-800 text-white border border-gray-600 rounded px-4 py-2" />
                                    <p className="text-gray-400 text-xs mt-1">Typical: 60-80 for mini, 40-60 for big table</p>
                                </div>
                                <div>
                                    <label className="block text-white font-semibold mb-2">Hours Played</label>
                                    <input type="number" value={hoursPlayed} onChange={(e) => setHoursPlayed(Math.max(0.5, parseFloat(e.target.value) || 2))} className="w-full bg-gray-800 text-white border border-gray-600 rounded px-4 py-2" step="0.5" />
                                </div>
                            </div>
                        </div>

                        <div className="bg-black/60 backdrop-blur-sm rounded-lg p-6 mb-6 border border-purple-800/50">
                            <h2 className="text-2xl font-bold text-white mb-4">Select Baccarat Variant</h2>
                            <div className="grid md:grid-cols-2 gap-4 mb-4">
                                {Object.entries(gameVariants).map(([key, variant]) => (
                                    <button key={key} onClick={() => setSelectedVariant(key)} className={`text-left p-4 rounded-lg border-2 transition-all ${selectedVariant === key ? 'border-green-500 bg-green-900/30' : 'border-gray-600 bg-gray-800/30 hover:border-gray-500'}`}>
                                        <h3 className="text-white font-bold text-lg mb-1">{variant.name}</h3>
                                        <p className="text-gray-400 text-sm mb-2">{variant.description}</p>
                                        <div className="flex gap-4 text-xs">
                                            <span className="text-red-400">Banker: {variant.bankerHouseEdge.toFixed(4)}%</span>
                                            <span className="text-blue-400">Player: {variant.playerHouseEdge.toFixed(4)}%</span>
                                        </div>
                                    </button>
                                ))}
                            </div>
                            <div className="flex gap-4">
                                <button onClick={() => setBetType('banker')} className={`flex-1 py-3 rounded-lg font-semibold ${betType === 'banker' ? 'bg-red-600 text-white' : 'bg-gray-700 text-gray-300'}`}>Betting on BANKER</button>
                                <button onClick={() => setBetType('player')} className={`flex-1 py-3 rounded-lg font-semibold ${betType === 'player' ? 'bg-blue-600 text-white' : 'bg-gray-700 text-gray-300'}`}>Betting on PLAYER</button>
                            </div>
                        </div>

                        <div className="grid md:grid-cols-4 gap-4 mb-6">
                            <div className="bg-gradient-to-br from-red-900/40 to-red-700/20 rounded-lg p-5 border border-red-700/50">
                                <div className="flex items-center gap-2 mb-2"><TrendingDown /><h3 className="text-white font-semibold">House Edge</h3></div>
                                <p className="text-4xl font-bold text-red-400">{currentResults.houseEdge.toFixed(4)}%</p>
                                <p className="text-gray-400 text-sm">Per hand expectation</p>
                            </div>
                            <div className="bg-gradient-to-br from-orange-900/40 to-orange-700/20 rounded-lg p-5 border border-orange-700/50">
                                <div className="flex items-center gap-2 mb-2"><DollarSign /><h3 className="text-white font-semibold">Expected Loss</h3></div>
                                <p className="text-4xl font-bold text-orange-400">{formatCurrency(currentResults.expectedLoss)}</p>
                                <p className="text-gray-400 text-sm">Over {currentResults.totalHands} hands</p>
                            </div>
                            <div className="bg-gradient-to-br from-yellow-900/40 to-yellow-700/20 rounded-lg p-5 border border-yellow-700/50">
                                <div className="flex items-center gap-2 mb-2"><Clock /><h3 className="text-white font-semibold">Cost Per Hour</h3></div>
                                <p className="text-4xl font-bold text-yellow-400">{formatCurrency(currentResults.expectedCostPerHour)}</p>
                                <p className="text-gray-400 text-sm">Entertainment value</p>
                            </div>
                            <div className="bg-gradient-to-br from-purple-900/40 to-purple-700/20 rounded-lg p-5 border border-purple-700/50">
                                <div className="flex items-center gap-2 mb-2"><DollarSign /><h3 className="text-white font-semibold">Total Action</h3></div>
                                <p className="text-4xl font-bold text-purple-400">{formatCurrency(currentResults.totalWagered)}</p>
                                <p className="text-gray-400 text-sm">Total wagered</p>
                            </div>
                        </div>

                        <div className="bg-black/60 backdrop-blur-sm rounded-lg p-6 mb-6 border border-green-800/50">
                            <h2 className="text-2xl font-bold text-white mb-4">Session Analysis: {currentVariant.name}</h2>
                            <div className="grid md:grid-cols-2 gap-6 mb-6">
                                <div>
                                    <h3 className="text-xl font-semibold text-white mb-3">Expected Value Calculation</h3>
                                    <div className="bg-gray-800/50 p-4 rounded">
                                        <p className="text-gray-300 mb-2">Formula: E(Loss) = Total Wagered × House Edge</p>
                                        <p className="text-white font-mono text-sm">= ${baseBet} × {currentResults.totalHands} hands × {currentResults.houseEdge.toFixed(4)}%</p>
                                        <p className="text-white font-mono text-sm">= {formatCurrency(currentResults.totalWagered)} × {(currentResults.houseEdge / 100).toFixed(6)}</p>
                                        <p className="text-red-400 font-mono text-lg mt-2">= {formatCurrency(currentResults.expectedLoss)}</p>
                                    </div>
                                </div>
                                <div>
                                    <h3 className="text-xl font-semibold text-white mb-3">Bankroll Requirements</h3>
                                    <div className="space-y-2 text-gray-300">
                                        <div className="flex justify-between"><span>Standard deviation:</span><span className="text-white font-semibold">{formatCurrency(currentResults.standardDeviation)}</span></div>
                                        <div className="flex justify-between"><span>95% survival bankroll:</span><span className="text-green-400 font-semibold">{formatCurrency(currentResults.required95Bankroll)}</span></div>
                                        <div className="flex justify-between"><span>99% survival bankroll:</span><span className="text-green-400 font-semibold">{formatCurrency(currentResults.required99Bankroll)}</span></div>
                                    </div>
                                    <p className="text-gray-400 text-xs mt-3">Calculated using normal approximation: Required = Expected Loss + (Z-score × σ)</p>
                                </div>
                            </div>
                            <div className="bg-blue-900/20 border border-blue-700/50 rounded-lg p-4">
                                <div className="flex items-start gap-3">
                                    <AlertCircle />
                                    <div>
                                        <h4 className="text-white font-semibold mb-1">About This Variant</h4>
                                        <p className="text-gray-300 text-sm">{currentVariant.notes}</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div className="grid md:grid-cols-2 gap-6 mb-6">
                            <div className="bg-black/60 backdrop-blur-sm rounded-lg p-6 border border-yellow-800/50">
                                <h3 className="text-xl font-bold text-white mb-4">House Edge Comparison</h3>
                                <ResponsiveContainer width="100%" height={300}>
                                    <BarChart data={edgeComparisonData}>
                                        <CartesianGrid strokeDasharray="3 3" stroke="#444" />
                                        <XAxis dataKey="name" stroke="#888" angle={-20} textAnchor="end" height={80} style={{fontSize:'11px'}} />
                                        <YAxis stroke="#888" />
                                        <Tooltip contentStyle={{backgroundColor:'#1a1a1a',border:'1px solid #444'}} formatter={(value) => `${value.toFixed(4)}%`} />
                                        <Legend />
                                        <Bar dataKey="Banker Edge" fill="#ef4444" />
                                        <Bar dataKey="Player Edge" fill="#3b82f6" />
                                    </BarChart>
                                </ResponsiveContainer>
                                <p className="text-gray-400 text-xs mt-2">Lower is better. Traditional 5% commission offers lowest Banker edge.</p>
                            </div>

                            <div className="bg-black/60 backdrop-blur-sm rounded-lg p-6 border border-orange-800/50">
                                <h3 className="text-xl font-bold text-white mb-4">Expected Loss Comparison</h3>
                                <ResponsiveContainer width="100%" height={300}>
                                    <BarChart data={costComparisonData}>
                                        <CartesianGrid strokeDasharray="3 3" stroke="#444" />
                                        <XAxis dataKey="name" stroke="#888" angle={-20} textAnchor="end" height={80} style={{fontSize:'11px'}} />
                                        <YAxis stroke="#888" />
                                        <Tooltip contentStyle={{backgroundColor:'#1a1a1a',border:'1px solid #444'}} formatter={(value) => formatCurrency(value)} />
                                        <Legend />
                                        <Bar dataKey="Banker Bet" fill="#dc2626" />
                                        <Bar dataKey="Player Bet" fill="#2563eb" />
                                    </BarChart>
                                </ResponsiveContainer>
                                <p className="text-gray-400 text-xs mt-2">Based on {formatCurrency(baseBet)} × {currentResults.totalHands} hands</p>
                            </div>
                        </div>

                        <div className="bg-black/60 backdrop-blur-sm rounded-lg p-6 mb-6 border border-gray-700/50">
                            <h2 className="text-2xl font-bold text-white mb-4">Understanding Commission Structures</h2>
                            <div className="space-y-4 text-gray-300">
                                <div>
                                    <h3 className="text-lg font-semibold text-white mb-2">Why "No Commission" Has Higher House Edge</h3>
                                    <p>Despite eliminating the 5% commission, "No Commission" baccarat has a HIGHER house edge (1.4613% vs 1.0579%) because it pays only 1:2 when Banker wins with a 6. This occurs approximately 5.3% of hands, which more than compensates for removing the commission.</p>
                                </div>
                                <div>
                                    <h3 className="text-lg font-semibold text-white mb-2">Mathematical Basis</h3>
                                    <p>All house edges are calculated from exact combinatorial analysis of 4,998,398,275,503,360 possible 8-deck outcomes. Probabilities: Banker win = 0.458597, Player win = 0.446247, Tie = 0.095156. These produce the stated house edges through expected value calculation: E(X) = Σ(Outcome × Probability) - Wager.</p>
                                </div>
                                <div className="bg-yellow-900/20 border border-yellow-700/50 rounded p-4">
                                    <h4 className="text-yellow-400 font-semibold mb-2">Recommendation for Players</h4>
                                    <p>If available, 4% commission offers the best odds (0.6003%). Otherwise, stick with traditional 5% commission (1.0579%) rather than "No Commission" variants. Player bet house edge (1.2351%) is identical across all variants.</p>
                                </div>
                            </div>
                        </div>

                        <div className="bg-gray-900/60 backdrop-blur-sm rounded-lg p-6 border border-gray-700/50">
                            <p className="text-gray-400 text-sm">
                                <strong className="text-white">Calculator by Joey Shackelford</strong><br/>
                                All house edges verified against WizardofOdds.com combinatorial analysis. Traditional 5% commission: Banker = 1.0579%, Player = 1.2351%, Tie = 14.3596%. 
                                No Commission (Banker 6 pays 1:2): Banker = 1.4613%. Super 6 (Banker 6 pushes): Banker = 1.5398%. 4% commission: Banker = 0.6003%. 
                                Expected value calculations use formula E(Loss) = Total Wagered × House Edge. Variance values: Banker = 0.9295, Player = 0.9482. 
                                Bankroll requirements use normal approximation with Z-scores: 95% confidence = 1.96σ, 99% confidence = 2.576σ. 
                                Sources: WizardofOdds.com/games/baccarat/basics/ and WizardofOdds.com/games/baccarat/appendix/6/
                            </p>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<CommissionCalculator />, document.getElementById('root'));
    </script>
</body>
</html>
